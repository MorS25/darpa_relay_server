# Mapping Server

The mapping server receives mapping and telemetry messages from teams for logging and display.  Messages are accepted through the HTTP interface specified in the official SubT "Interface Control Document (ICD).

The server is primarily for use by DARPA for logging and monitoring team's mapping efforts and visualizing platform locations throughout the subterranean environment in real time.  The mapping server has been made public so that teams may test the integration of their system with the mapping server.

## Building

The subt\_mapping directory is configured as a catkin workspace.  To build the mapping\_server, simply run `catkin_make` in the subt\_mapping directory.  You may need to install dependant packages using rosdep or manual installation.  The required dependencies can be found in either the package.xml or CMakeLists.txt files of the mapping\_server package.

The mapping server can also be built into a docker image.  From the subt\_mapping/src directory, run `docker/build.bash` to generate the docker image.

## Running

The mapping server can be run manually or as a docker container.

To run manually, use `roslaunch mapping_server mapping_server.launch`.  You may set parameters in the launch file for your team token, the rosbag directory for logging data, and the name of your team.  See the launch file for more details on the parameters.

To run as a docker container, simply execute the `subt_mapping/src/docker/run.bash` script.  This will start up the mapping server and rviz inside of a docker container.  NOTE: Parameters (e.g. team token) should be hardcoded in the mapping\_server.launch file before calling the docker build.bash script.

## Logs

Log files generated by rosbag will be stored in the directory specified by the `bagdir` argument in the mapping\_server.launch file.  The log file names will contain the team name specified by the `teamname` argument in the mapping\_server.launch file.

Note: This version of the Test Mapping Server will respond with "HTTP_429_TOO_MANY_REQUESTS" if point cloud updates are sent at a rate greater than 1Hz. Point cloud updates should be sent less frequently to reduce network bandwidth usage.

